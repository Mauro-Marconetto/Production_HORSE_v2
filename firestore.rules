/**
 * @fileoverview Firestore Security Rules for ForgeFlow application.
 *
 * Core Philosophy:
 * This ruleset provides open access to the data, as requested by the user.
 *
 * Data Structure:
 * - /users/{userId}: Stores user profile information, with the document ID matching the user's Firebase Auth UID.
 * - /roles/{roleId}: Stores application roles and their permissions.
 * - /pieces/{pieceId}: Stores details of manufactured pieces.
 * - /molds/{moldId}: Stores information about molds used in production.
 * - /machines/{machineId}: Stores details about machines used in production.
 * - /demand/{periodoYYYYWW}/{pieceId}: Stores demand data for a specific piece in a specific period.
 * - /inventory/{pieceId}/{fechaISO}: Stores inventory levels for a specific piece on a specific date.
 * - /inventory/current/{pieceId}: Stores current inventory levels for a specific piece.
 * - /calendars/{machineId}/{periodoYYYYWW}: Stores calendar events for a specific machine in a specific period.
 * - /downtime/{machineId}/{YYYYMM}: Stores downtime events for a specific machine in a specific month.
 * - /downtime_agg/{machineId}/{YYYYMM}: Stores aggregated downtime data for a specific machine in a specific month.
 * - /plans/{planId}: Stores production plans.
 * - /plans/{planId}/assignments/{assignmentId}: Stores assignments of pieces and molds to machines within a production plan.
 * - /production/{productionId}: Stores actual production data for a specific date.
 * - /settings/global: Stores global settings for the application.
 * - /clients/{clientId}: Stores client information.
 *
 * Key Security Decisions:
 * - All read and write operations are allowed for all users (including unauthenticated users).
 *
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows any user to read and write user profile information.
     * @path /users/{userId}
     * @allow (create, update, delete) - Any user can create, update, or delete user profiles.
     * @allow (get, list) - Any user can read user profiles.
     * @deny None - This rule provides open access.
     * @principle Allows open access to user profiles.
     */
    match /users/{userId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write role information.
     * @path /roles/{roleId}
     * @allow (create, update, delete) - Any user can create, update, or delete roles.
     * @allow (get, list) - Any user can read roles.
     * @deny None - This rule provides open access.
     * @principle Allows open access to role information.
     */
    match /roles/{roleId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write piece information.
     * @path /pieces/{pieceId}
     * @allow (create, update, delete) - Any user can create, update, or delete pieces.
     * @allow (get, list) - Any user can read pieces.
     * @deny None - This rule provides open access.
     * @principle Allows open access to piece information.
     */
    match /pieces/{pieceId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write mold information.
     * @path /molds/{moldId}
     * @allow (create, update, delete) - Any user can create, update, or delete molds.
     * @allow (get, list) - Any user can read molds.
     * @deny None - This rule provides open access.
     * @principle Allows open access to mold information.
     */
    match /molds/{moldId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write machine information.
     * @path /machines/{machineId}
     * @allow (create, update, delete) - Any user can create, update, or delete machines.
     * @allow (get, list) - Any user can read machines.
     * @deny None - This rule provides open access.
     * @principle Allows open access to machine information.
     */
    match /machines/{machineId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write demand information.
     * @path /demand/{periodoYYYYWW}/{pieceId}
     * @allow (create, update, delete) - Any user can create, update, or delete demand.
     * @allow (get, list) - Any user can read demand.
     * @deny None - This rule provides open access.
     * @principle Allows open access to demand information.
     */
    match /demand/{periodoYYYYWW}/{pieceId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write inventory information.
     * @path /inventory/{pieceId}
     * @allow (create, update, delete) - Any user can create, update, or delete inventory.
     * @allow (get, list) - Any user can read inventory.
     * @deny None - This rule provides open access.
     * @principle Allows open access to inventory information.
     */
    match /inventory/{pieceId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write calendar information.
     * @path /calendars/{machineId}/{periodoYYYYWW}
     * @allow (create, update, delete) - Any user can create, update, or delete calendars.
     * @allow (get, list) - Any user can read calendars.
     * @deny None - This rule provides open access.
     * @principle Allows open access to calendar information.
     */
    match /calendars/{machineId}/{periodoYYYYWW} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write downtime information.
     * @path /downtime/{machineId}/{YYYYMM}
     * @allow (create, update, delete) - Any user can create, update, or delete downtime.
     * @allow (get, list) - Any user can read downtime.
     * @deny None - This rule provides open access.
     * @principle Allows open access to downtime information.
     */
    match /downtime/{machineId}/{YYYYMM} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write aggregated downtime information.
     * @path /downtime_agg/{machineId}/{YYYYMM}
     * @allow (create, update, delete) - Any user can create, update, or delete downtime_agg.
     * @allow (get, list) - Any user can read downtime_agg.
     * @deny None - This rule provides open access.
     * @principle Allows open access to downtime_agg information.
     */
    match /downtime_agg/{machineId}/{YYYYMM} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write plan information.
     * @path /plans/{planId}
     * @allow (create, update, delete) - Any user can create, update, or delete plans.
     * @allow (get, list) - Any user can read plans.
     * @deny None - This rule provides open access.
     * @principle Allows open access to plan information.
     */
    match /plans/{planId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write assignment information within a plan.
     * @path /plans/{planId}/assignments/{assignmentId}
     * @allow (create, update, delete) - Any user can create, update, or delete assignments.
     * @allow (get, list) - Any user can read assignments.
     * @deny None - This rule provides open access.
     * @principle Allows open access to assignment information.
     */
    match /plans/{planId}/assignments/{assignmentId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write production information.
     * @path /production/{productionId}
     * @allow (create, update, delete) - Any user can create, update, or delete production.
     * @allow (get, list) - Any user can read production.
     * @deny None - This rule provides open access.
     * @principle Allows open access to production information.
     */
    match /production/{productionId} {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write global settings.
     * @path /settings/global
     * @allow (create, update, delete) - Any user can create, update, or delete settings.
     * @allow (get, list) - Any user can read settings.
     * @deny None - This rule provides open access.
     * @principle Allows open access to global settings.
     */
    match /settings/global {
      allow read, write: if request.auth != null;
    }
    
    /**
     * @description Allows any user to read and write remito settings.
     * @path /settings/remitos
     * @allow (create, update, delete) - Any user can create, update, or delete remito settings.
     * @allow (get, list) - Any user can read remito settings.
     * @deny None - This rule provides open access.
     * @principle Allows open access to remito settings.
     */
    match /settings/remitos {
      allow read, write: if request.auth != null;
    }

    /**
     * @description Allows any user to read and write client information.
     * @path /clients/{clientId}
     * @allow (create, update, delete) - Any user can create, update, or delete clients.
     * @allow (get, list) - Any user can read clients.
     * @deny None - This rule provides open access.
     * @principle Allows open access to client information.
     */
    match /clients/{clientId} {
      allow read, write: if request.auth != null;
    }
    
    /**
     * @description Allows any user to read and write supplier information.
     * @path /suppliers/{supplierId}
     * @allow (create, update, delete) - Any user can create, update, or delete suppliers.
     * @allow (get, list) - Any user can read suppliers.
     * @deny None - This rule provides open access.
     * @principle Allows open access to supplier information.
     */
    match /suppliers/{supplierId} {
      allow read, write: if request.auth != null;
    }
    
    /**
     * @description Allows any user to read and write remito information.
     * @path /remitos/{remitoId}
     * @allow (create, update, delete) - Any user can create, update, or delete remitos.
     * @allow (get, list) - Any user can read remitos.
     * @deny None - This rule provides open access.
     * @principle Allows open access to remito information.
     */
    match /remitos/{remitoId} {
      allow read, write: if request.auth != null;
    }
    
     /**
     * @description Allows any user to read and write machining process information.
     * @path /machining/{machiningId}
     * @allow (create, update, delete) - Any user can create, update, or delete machining records.
     * @allow (get, list) - Any user can read machining records.
     * @deny None - This rule provides open access.
     * @principle Allows open access to machining process information.
     */
    match /machining/{machiningId} {
      allow read, write: if request.auth != null;
    }
  }
}
